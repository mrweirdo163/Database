use QLGiaoVien
go

----------35------------
select MAX(LUONG) as LuongCaoNhat
from GIAOVIEN


----------36-----------
SELECT MAGV, HOTEN, LUONG
FROM GIAOVIEN
WHERE LUONG = (SELECT MAX(LUONG) FROM GIAOVIEN);


---------37-----------
SELECT MAX(LUONG) AS LuongCaoNhat
FROM GIAOVIEN
WHERE MABM = 'HTTT'


----------38-----------
SELECT TOP 1 GV.HOTEN
FROM GIAOVIEN GV
WHERE GV.MABM = 'HTTT'
ORDER BY YEAR(GV.NGSINH) ASC


---------39----------
SELECT TOP 1 GV.HOTEN
FROM GIAOVIEN GV, BOMON BM
WHERE GV.MABM = BM.MABM
AND BM.MAKHOA = 'CNTT'
ORDER BY YEAR(GV.NGSINH) DESC


-----------40-----------
SELECT GV.HOTEN, KHOA.TENKHOA
FROM GIAOVIEN GV, BOMON BM, KHOA
WHERE GV.MABM = BM.MABM
AND BM.MAKHOA = KHOA.MAKHOA
AND GV.LUONG = (SELECT MAX(LUONG) FROM GIAOVIEN)



---------41-----------
SELECT GV.MAGV, GV.HOTEN, GV.MABM
FROM GIAOVIEN GV
WHERE GV.LUONG >= ALL (SELECT GV1.LUONG FROM GIAOVIEN GV1 WHERE GV1.MABM = GV.MABM)


----------42----------
SELECT DT.TENDT
FROM GIAOVIEN GV, DETAI DT
WHERE GV.HOTEN = N'Nguyễn Hoài An'
AND GV.MAGV NOT IN ( SELECT PC.MAGV
					FROM THAMGIADT PC
					WHERE PC.MADT = DT.MADT)


--------43---------
SELECT DT.TENDT, CN.HOTEN
FROM GIAOVIEN GV, DETAI DT, GIAOVIEN CN
WHERE GV.HOTEN = N'Nguyễn Hoài An'
AND GV.MAGV NOT IN ( SELECT PC.MAGV
					FROM THAMGIADT PC
					WHERE PC.MADT = DT.MADT)
AND DT.GVCNDT = CN.MAGV


---------44-----------
SELECT GV.MAGV, GV.HOTEN
FROM GIAOVIEN GV, BOMON BM
WHERE GV.MABM = BM.MABM
AND BM.MAKHOA = 'CNTT'
AND GV.MAGV NOT IN (SELECT PC.MAGV
					FROM THAMGIADT PC)


--------45----------
SELECT GV.MAGV, GV.HOTEN
FROM GIAOVIEN GV
WHERE GV.MAGV NOT IN (SELECT MAGV
					FROM THAMGIADT)



---------46---------
SELECT GV.MAGV, GV.HOTEN
FROM GIAOVIEN GV, GIAOVIEN NHA
WHERE NHA.HOTEN = N'Nguyễn Hoài An'
AND GV.LUONG > NHA.LUONG


--------47----------
SELECT TBM.MAGV, TBM.HOTEN
FROM GIAOVIEN TBM, BOMON BM
WHERE TBM.MAGV = BM.TRUONGBM
AND TBM.MAGV IN (SELECT MAGV
					FROM THAMGIADT)


--------48-----------
SELECT GV1.MAGV, GV1.HOTEN, GV1.PHAI, GV1.MABM
FROM GIAOVIEN GV1
INNER JOIN GIAOVIEN GV2
    ON GV1.MAGV <> GV2.MAGV 
    AND GV1.HOTEN = GV2.HOTEN 
    AND GV1.PHAI = GV2.PHAI 
    AND GV1.MABM = GV2.MABM



---------49----------
SELECT GV.MAGV, GV.HOTEN
FROM GIAOVIEN GV
WHERE GV.LUONG >= (SELECT MIN(GV1.LUONG)
					FROM GIAOVIEN GV1, BOMON BM
					WHERE GV1.MAGV <> GV.MAGV
					AND GV1.MABM = BM.MABM
					AND BM.TENBM = N'Công nghệ phần mềm')


---------50------------
SELECT GV.MAGV, GV.HOTEN
FROM GIAOVIEN GV
WHERE GV.LUONG > (SELECT MAX(GV1.LUONG)
					FROM GIAOVIEN GV1, BOMON BM
					WHERE GV1.MAGV <> GV.MAGV
					AND GV1.MABM = BM.MABM
					AND BM.TENBM = N'Hệ thống thông tin')



--------51-------------
SELECT TOP 1 KHOA.TENKHOA, COUNT(*) AS NumberOfTeachers
FROM GIAOVIEN GV, BOMON BM, KHOA
WHERE GV.MABM = BM.MABM
AND BM.MAKHOA = KHOA.MAKHOA
GROUP BY KHOA.TENKHOA
ORDER BY NumberOfTeachers DESC


--------52-----------
SELECT TOP 1 COUNT(*) AS SoLuongDeTai, GV.MAGV, GV.HOTEN
FROM GIAOVIEN GV, DETAI DT
WHERE DT.GVCNDT = GV.MAGV
GROUP BY DT.GVCNDT, GV.MAGV, GV.HOTEN
ORDER BY SoLuongDeTai DESC


---------53---------
SELECT MABM
FROM GIAOVIEN
GROUP BY MABM
HAVING COUNT(*) >=	ALL	( SELECT	COUNT(*)
						FROM GIAOVIEN GV
						GROUP BY GV.MABM)



---------54----------
SELECT TOP 1 GV.HOTEN, GV.MABM, COUNT(DISTINCT PC.MADT) AS SoLuongDeTai
FROM GIAOVIEN GV
INNER JOIN THAMGIADT PC ON GV.MAGV = PC.MAGV
GROUP BY GV.HOTEN, GV.MABM
ORDER BY SoLuongDeTai DESC


---------55-----------
SELECT TOP 1 GV.HOTEN, COUNT(DISTINCT PC.MADT) AS SoLuongDeTai
FROM GIAOVIEN GV
INNER JOIN THAMGIADT PC ON GV.MAGV = PC.MAGV
WHERE GV.MABM = 'HTTT'
GROUP BY GV.HOTEN
ORDER BY SoLuongDeTai DESC


---------56----------
SELECT TOP 1 GV.HOTEN, BM.TENBM, COUNT(*) AS SoLuongNguoiThan
FROM GIAOVIEN GV, BOMON BM, NGUOITHAN NT
WHERE GV.MABM = BM.MABM
AND GV.MAGV = NT.MAGV
GROUP BY GV.HOTEN, BM.TENBM
ORDER BY SoLuongNguoiThan DESC


-----------57------------
SELECT TOP 1 TBM.HOTEN, COUNT(*) AS SoLuongDeTai
FROM GIAOVIEN TBM, BOMON BM, DETAI DT
WHERE TBM.MAGV = BM.TRUONGBM
AND TBM.MAGV = DT.GVCNDT
GROUP BY TBM.HOTEN
ORDER BY SoLuongDeTai DESC