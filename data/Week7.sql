use QLGiaoVien
go

------------58------------
SELECT GV.HOTEN
FROM GIAOVIEN GV
WHERE NOT EXISTS (
    SELECT CD.MACD
    FROM CHUDE CD
    WHERE NOT EXISTS (
        SELECT DT.MADT
        FROM DETAI DT
        WHERE DT.MACD = CD.MACD
        AND EXISTS (
            SELECT TG.MADT
            FROM THAMGIADT TG
            WHERE TG.MADT = DT.MADT
            AND TG.MAGV = GV.MAGV
        )
    )
)

----------59----------
SELECT DT.TENDT
FROM DETAI DT
WHERE NOT EXISTS (
	SELECT *
	FROM GIAOVIEN GV
	WHERE GV.MABM = 'HTTT'
	AND NOT EXISTS (
		SELECT *
		FROM THAMGIADT TG
		WHERE TG.MAGV = GV.MAGV
		AND TG.MADT = DT.MADT
	)
)


---------60-----------
SELECT DT.TENDT
FROM DETAI DT
WHERE NOT EXISTS (
	SELECT *
	FROM GIAOVIEN GV
	WHERE GV.MABM = 'HTTT'
	AND NOT EXISTS (
		SELECT *
		FROM THAMGIADT TG
		WHERE TG.MAGV = GV.MAGV
		AND TG.MADT = DT.MADT
	)
)


------------61------------
SELECT GV.MAGV, GV.HOTEN
FROM GIAOVIEN GV
WHERE NOT EXISTS (
	SELECT *
	FROM DETAI DT
	WHERE DT.MACD = 'QLGD'
	AND NOT EXISTS (
		SELECT *
		FROM THAMGIADT TG
		WHERE TG.MADT = DT.MADT
		AND TG.MAGV = GV.MAGV
	)
)



----------62------------
SELECT GV.HOTEN
FROM GIAOVIEN GV
WHERE NOT EXISTS (
    SELECT DT.MADT
    FROM DETAI DT
    WHERE NOT EXISTS (
        SELECT TG.MADT
        FROM THAMGIADT TG
        WHERE TG.MADT = DT.MADT
        AND TG.MAGV = GV.MAGV
    )
    AND EXISTS (
        SELECT TG2.MADT
        FROM THAMGIADT TG2, GIAOVIEN TTH
		  WHERE TG2.MAGV = TTH.MAGV
		  AND TTH.HOTEN = N'Trần Trà Hương'
        AND TG2.MADT = DT.MADT
	)
)
AND GV.HOTEN <> N'Trần Trà Hương'


----------63-----------
SELECT DT.TENDT
FROM DETAI DT
WHERE NOT EXISTS (
	SELECT *
	FROM GIAOVIEN GV
	WHERE GV.MABM = 'HHC'
	AND NOT EXISTS (
		SELECT *
		FROM THAMGIADT TG
		WHERE TG.MAGV = GV.MAGV
		AND TG.MADT = DT.MADT
	)
)


---------64------------
SELECT GV.HOTEN
FROM GIAOVIEN GV
WHERE NOT EXISTS (
    SELECT CV.MADT, CV.SOTT
    FROM CONGVIEC CV
    WHERE CV.MADT = '006'
    AND NOT EXISTS (
        SELECT TG.MADT, TG.STT
        FROM THAMGIADT TG
        WHERE TG.MADT = CV.MADT
        AND TG.STT = CV.SOTT
        AND TG.MAGV = GV.MAGV
    )
)
AND EXISTS (
    SELECT TG2.MADT, TG2.STT
    FROM THAMGIADT TG2
    WHERE TG2.MADT = '006'
    AND TG2.MAGV = GV.MAGV
)


----------65-----------
SELECT GV.MAGV, GV.HOTEN
FROM GIAOVIEN GV
WHERE NOT EXISTS (
	SELECT *
	FROM DETAI DT
	WHERE DT.MACD = 'ƯDCN'
	AND NOT EXISTS (
		SELECT *
		FROM THAMGIADT TG
		WHERE TG.MADT = DT.MADT
		AND TG.MAGV = GV.MAGV
	)
)

---------66----------
SELECT GV.MAGV, GV.HOTEN
FROM GIAOVIEN GV
WHERE NOT EXISTS (
	SELECT *
	FROM DETAI DT
	WHERE NOT EXISTS (
		SELECT *
		FROM THAMGIADT TG
		WHERE TG.MADT = DT.MADT
		AND TG.MAGV = GV.MAGV
	)
	AND EXISTS (
		SELECT *
		FROM THAMGIADT TG2, GIAOVIEN TTH
		WHERE TTH.HOTEN = N'Trần Trà Hương'
		AND DT.GVCNDT = TTH.MAGV
	)
)


----------67----------
SELECT DT.TENDT
FROM DETAI DT
WHERE NOT EXISTS (
	SELECT *
	FROM GIAOVIEN GV, BOMON BM
	WHERE GV.MABM = BM.MABM
	AND BM.MAKHOA = 'CNTT'
	AND NOT EXISTS (
		SELECT *
		FROM THAMGIADT TG
		WHERE TG.MADT = DT.MADT
		AND TG.MAGV = GV.MAGV
	)
)



--------68-----------
SELECT GV.HOTEN
FROM GIAOVIEN GV
WHERE NOT EXISTS (
    SELECT DISTINCT CV.SOTT
    FROM CONGVIEC CV
    WHERE CV.MADT = (
        SELECT MADT
        FROM DETAI
        WHERE TENDT = N'Nghiên cứu tế bào gốc'
    )
    AND NOT EXISTS (
        SELECT TG.STT
        FROM THAMGIADT TG
        WHERE TG.MADT = CV.MADT
        AND TG.STT = CV.SOTT
        AND TG.MAGV = GV.MAGV
    )
)



----------69----------
SELECT DISTINCT GV.HOTEN
FROM GIAOVIEN GV, THAMGIADT TG, DETAI DT
WHERE GV.MAGV = TG.MAGV
AND TG.MADT = DT.MADT
AND DT.KINHPHI > 100


---------70------------
SELECT DT.TENDT
FROM DETAI DT
WHERE NOT EXISTS (
	SELECT *
	FROM GIAOVIEN GV, BOMON BM, KHOA
	WHERE GV.MABM = BM.MABM
	AND BM.MAKHOA = KHOA.MAKHOA
	AND KHOA.TENKHOA = N'Sinh học'
	AND NOT EXISTS (
		SELECT *
		FROM THAMGIADT TG
		WHERE TG.MADT = DT.MADT
		AND TG.MAGV = GV.MAGV
	)
)


----------71-------------
SELECT GV.MAGV, GV.HOTEN, GV.NGSINH
FROM GIAOVIEN GV
WHERE NOT EXISTS (
	SELECT DISTINCT CV.SOTT
	FROM CONGVIEC CV
	WHERE CV.MADT = (
		SELECT MADT
		FROM DETAI
		WHERE TENDT = N'Ứng dụng hóa học xanh'
	)
	AND NOT EXISTS (
		SELECT TG.STT
		FROM THAMGIADT TG
		WHERE TG.STT = CV.SOTT
		AND TG.MADT = CV.MADT
		AND TG.MAGV = GV.MAGV
	)
)


-----------72----------
SELECT GV.MAGV, GV.HOTEN, BM.TENBM, GVQL.HOTEN
FROM GIAOVIEN GV, GIAOVIEN GVQL, BOMON BM
WHERE GV.MABM = BM.MABM
AND GV.GVQLCM = GVQL.MAGV
AND NOT EXISTS (
	SELECT *
	FROM CHUDE CD
	WHERE CD.TENCD = N'Nghiên cứu phát triển'
	AND NOT EXISTS (
		SELECT *
		FROM DETAI DT
		WHERE DT.MACD = CD.MACD
		AND NOT EXISTS (
			SELECT *
			FROM THAMGIADT TG
			WHERE TG.MADT = DT.MADT
			AND TG.MAGV = GV.MAGV
		)
	)
)